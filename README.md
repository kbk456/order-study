## 상품 주문 프로그램 

# 프로젝트 구조

프로젝트는 다음과 같은 구조로 이루어져 있습니다

- `interface`: 사용자에게 정보를 보여주고 사용자의 명령을 해석하며 application 을 참조합니다 
- `application/`: interface 에서 호출하고 도메인 객체가 문제를 해결하도록 위임합니다
- `domain/`: 업무용 소프트웨어의 핵심 계층이며, 업무 개념과 상황에 대한 정보 등을 담당하며 세부적인 구현은 infrastructure에 위임합니다
- `infrastructure/`: 상위 계층을 지원하며 low level 구현체가 있습니다 
- `Demo1Application`: 프로그램이 시작되고, 주로 주문 프로그램을 실행하기 위한 주문 입력 값을 받아서 interface의 api를 호출하고, 콘솔에 데이터를 출력하는 부분입니다 

# 구현 방향
- 도메인 레이어의 서비스에서 도메인의 전체적인 흐름을 파악할수 있도록 구현하였습니다
- 서비스에서는 인터페이스를 선언하고 세세한 구현은 인프라스트럭쳐에 위임하여
- DIP 를 활용하여 도메인이 사용하는 인터페이스의 실제 구현체를 주입받아 사용할수 있도록 하였습니다
- 추상화 레벨을 높혀서 가독성과 유지보수성을 높이려고 노력하였습니다
- 메서드명을 읽기 쉽도록 일반적인 네이밍으로 정하여 사용하였습니다
- 계층 간의 데이터 전송은 커멘드나 DTO를 사용하여 결합도를 낮추려고 노력하였습니다

# 프로세스 흐름
- 콘솔에서 스케너를 이용해서 사용자의 상품 주문을 받아서
- 주문 정보를 조회한 후, 주문을 등록하였습니다 
- 주문을 결제할때, 재고 수량을 체크하고 예외 처리를 하거나 수량을 차감하고 주문 상태를 변경하였습니다
- 정상 주문된 주문 내역을 조회해서 출력하였습니다
- 테스트는 동시 쓰레드를 호출하여 정상적으로 주문이 되고, 재고에 대한 예외처리를 확인하였습니다
- 재고가 없는 경우는 주문상태가 INIT으로 저장되도록 하였습니다

# 기본 환경
- JDK 17
- 도커 데스크탑

# 실행 방법
- 다운받은 프로젝트 파일의 압축을 풀고 인텔리제이로 프로젝트를 열기
- 프로젝트 파일의 루트디렉터리에 있는 docker-compose 디렉터리로 이동
- docker compose up -d 명령어를 실행
```bash
 docker-compose -f docker-compose/docker-compose.yml up -d
```
- 인텔리제이의 데이터베이스 도구에서 mysql 데이터베이스 소스를 설정
- docker-compose.yml 파일의 접속정보를 참고해서 데이터베이스 연결
- 스프링부트 프로젝트를 실행하면 플라이웨이가 실행되면서 order DB가 생성되고 아이템 테이블에 테스트 데이터를 저장되도록 하였습니다
- 아래 콘솔에서 상품을 주문할수 있습니다
- 테스트 코드를 이용해서 동시 주문 테스트를 확인할수 있습니다 

